function [Sp] = StarProduct(S1,S2)


Sp11 =  S1([1 2],[1 2]) + S1([1 2],[3 4])*inv(eye(2) - S2([1 2],[1 2])*S1([3 4],[3 4]))*S2([1 2],[1 2])*S1([3 4],[1 2]);

Sp12 =  S1([1 2],[3 4])*inv(eye(2) - S2([1 2],[1 2])*S1([3 4],[3 4]))*S2([1 2],[3 4]);

Sp21 =  S2([3 4],[1 2])*inv(eye(2) - S1([3 4],[3 4])*S2([1 2],[1 2]))*S1([3 4],[1 2]);
Sp22 =  S2([3 4],[3 4]) + S2([3 4],[1 2])*inv(eye(2) - S1([3 4],[3 4])*S2([1 2],[1 2]))*S1([3 4],[3 4])*S2([1 2],[3 4]);

Sp = [Sp11 Sp12; Sp21 Sp22];


